 import React from 'react'; import { motion } from 'framer-motion'; import { useWorkflowStore } from '@/stores/workflowStore'; import { WorkflowStatus } from '@/types'; import { Play, Pause, Square, RotateCcw, Eye, EyeOff } from 'lucide-react'; export const WorkflowControls: React.FC = () => { const { currentWorkflow, isRealTimeConnected, darkMode, setDarkMode, viewMode, setViewMode } = useWorkflowStore(); const handlePlayPause = () => { // This would typically trigger workflow start/resume via API // For now, we'll just log the action console.log('Play/Pause clicked'); }; const handleReset = () => { if (currentWorkflow) { console.log('Reset workflow:', currentWorkflow.id); // Would call API to reset workflow } }; const handleToggleView = () => { setViewMode(viewMode === 'canvas' ? 'list' : 'canvas'); }; const handleToggleDarkMode = () => { setDarkMode(!darkMode); if (!darkMode) { document.documentElement.classList.add('dark'); } else { document.documentElement.classList.remove('dark'); } }; const getStatusColor = (status: WorkflowStatus) => { switch (status) { case WorkflowStatus.RUNNING: return 'text-blue-600'; case WorkflowStatus.COMPLETED: return 'text-green-600'; case WorkflowStatus.FAILED: return 'text-red-600'; case WorkflowStatus.CANCELLED: return 'text-gray-600'; default: return 'text-gray-600'; } }; const getStatusIcon = (status: WorkflowStatus) => { switch (status) { case WorkflowStatus.RUNNING: return <Pause className="w-4 h-4" />; case WorkflowStatus.COMPLETED: case WorkflowStatus.FAILED: case WorkflowStatus.CANCELLED: return <Square className="w-4 h-4" />; default: return <Play className="w-4 h-4" />; } }; const getStatusText = (status: WorkflowStatus) => { switch (status) { case WorkflowStatus.INITIALIZING: return 'Initializing'; case WorkflowStatus.RUNNING: return 'Running'; case WorkflowStatus.CONTENT_GENERATION: return 'Generating Content'; case WorkflowStatus.WEB_SEARCH_CRITIC: return 'Validating Accuracy'; case WorkflowStatus.QUALITY_CRITIC: return 'Evaluating Quality'; case WorkflowStatus.HUMAN_REVIEW: return 'Human Review'; case WorkflowStatus.COMPLETED: return 'Completed'; case WorkflowStatus.FAILED: return 'Failed'; case WorkflowStatus.CANCELLED: return 'Cancelled'; default: return 'Unknown'; } }; return ( <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.3 }} className="bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 p-4" > <div className="flex items-center justify-between mb-4"> <div className="flex items-center space-x-4"> <h3 className="text-lg font-semibold text-gray-900 dark:text-gray-100"> Workflow Controls</h3> {currentWorkflow && ( <div className="flex items-center space-x-2"> <span className={`status-badge ${getStatusColor(currentWorkflow.status)}`}> {getStatusText(currentWorkflow.status)} </span> <span className="text-sm text-gray-500 dark:text-gray-400"> Cycle {currentWorkflow.currentCycle}/{currentWorkflow.maxCycles} </span> </div> )} </div> <div className="flex items-center space-x-2"> <button onClick={handleToggleDarkMode} className="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" title="Toggle dark mode" > {darkMode ? <EyeOff className="w-4 h-4" /> : <Eye className="w-4 h-4" />} </button> <button onClick={handleToggleView} className="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" title={`Switch to ${viewMode === 'canvas' ? 'list' : 'canvas'} view`} > {viewMode === 'canvas' ? 'ðŸ“‹' : 'ðŸŽ¨'} </button> </div> </div> <div className="flex items-center space-x-3"> <div className="flex items-center space-x-2"> <div className={`w-3 h-3 rounded-full ${isRealTimeConnected ? 'bg-green-500' : 'bg-gray-300'} animate-pulse`} /> <span className="text-sm text-gray-600 dark:text-gray-400"> {isRealTimeConnected ? 'Connected' : 'Disconnected'} </span> </div> {currentWorkflow && ( <div className="flex items-center space-x-2 ml-auto"> <button onClick={handlePlayPause} className={`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors ${ currentWorkflow.status === WorkflowStatus.RUNNING ? 'bg-orange-500 hover:bg-orange-600 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white' }`} disabled={currentWorkflow.status === WorkflowStatus.COMPLETED || currentWorkflow.status === WorkflowStatus.FAILED} > {getStatusIcon(currentWorkflow.status)} <span>{currentWorkflow.status === WorkflowStatus.RUNNING ? 'Pause' : 'Start'}</span> </button> <button onClick={handleReset} className="flex items-center space-x-2 px-4 py-2 rounded-lg font-medium bg-gray-500 hover:bg-gray-600 text-white transition-colors" disabled={!currentWorkflow || currentWorkflow.status === WorkflowStatus.INITIALIZING} > <RotateCcw className="w-4 h-4" /> <span>Reset</span> </button> </div> )} </div> {/* Progress indicator */ {currentWorkflow && currentWorkflow.status !== WorkflowStatus.INITIALIZING && ( <div className="mt-4"> <div className="flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-1"> Progress </div> <div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"> <motion.div className="bg-blue-500 h-2 rounded-full" initial={{ width: 0 }} animate={{ width: `${(currentWorkflow.currentCycle / currentWorkflow.maxCycles) * 100}%` }} transition={{ duration: 0.5 }} /> </div> </div> )} {/* Quality Score */ {currentWorkflow && currentWorkflow.finalQualityScore && ( <div className="mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"> <div className="flex justify-between items-center"> <span className="text-sm font-medium text-gray-700 dark:text-gray-300">Final Quality Score</span> <span className={`text-lg font-bold ${ currentWorkflow.finalQualityScore >= 7 ? 'text-green-600' : currentWorkflow.finalQualityScore >= 5 ? 'text-yellow-600' : 'text-red-600' }`} > {currentWorkflow.finalQualityScore.toFixed(1)}/10 </span> </div> </div> )} {/* Human Review Status */ {currentWorkflow && currentWorkflow.humanReviewRequired && ( <div className="mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg"> <div className="flex justify-between items-center"> <span className="text-sm font-medium text-yellow-800 dark:text-yellow-200">Human Review Required</span> <span className={`text-sm font-medium ${currentWorkflow.humanReviewProvided ? 'text-green-600' : 'text-yellow-600' }`} > {currentWorkflow.humanReviewProvided ? 'Provided' : 'Pending'} </span> </div> {currentWorkflow.humanReviewFeedback && ( <p className="mt-2 text-xs text-yellow-700 dark:text-yellow-300 italic"> "{currentWorkflow.humanReviewFeedback}" </p> )} </div> )} </motion.div> ); }; export default WorkflowControls; 